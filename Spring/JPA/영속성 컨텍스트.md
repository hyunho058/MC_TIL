# 영속성 컨텍스트

> * 엔티티를 영구 저장하는 환경
> * 엔티티 매니저를 통해서 영속성 컨텍스트에 접근

![image-20210412074246848](영속성 컨텍스트.assets/image-20210412074246848.png)

## 엔티티의 생명주기

* 비영속(new/transient)

  * 영속성 컨텍스트와 전혀 관계가 없는 **새로운** 상태

  ```java
  //비영속
  Member member = new Member();
  member.setId(100);
  member.setName("name");
  ```

* 영속(managed)

  * 영속성 컨텍스트에 **관리**되는 상태

  ```java
  //영속
  em.persist(member);
  ```

* 준영속(detached)

  * 영속성 컨텍스트에 저장되었다가 **분리**된상태

  ```java
  em.detach(member) => //영속성 컨텍스트에서 지운다 (관계x)
  ```

* 삭제(remove)

  * 삭제된 상태

  ```java
  em.remove(member) => //DB삭제 요청 상태(영구 저장한 DB에서 제거)
  ```

## 영속성 컨텍스트의 이점

* 1차 캐시
* 동일성(identity) 보장
* 트랜택션을 지원하는 쓰기 지연(transactional write-behind)
* 변경 감지(Dirty Checking)
* 지연 로딩(Lazy Loading)

